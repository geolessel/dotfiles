### Key bindings

### Make sure we pass on that we can handle colors
set -g default-terminal "tmux-256color"

set-option -g default-shell /bin/zsh
set-option -g default-command "ZDOTDIR=~ zsh"

set-option -g prefix C-b

# New window keys (start in current path)
unbind % # Remove default binding
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

### Use vim-style movement keys to change panes/windows
set-option -g status-keys vi
set-window-option -g mode-keys vi
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
bind -r H resize-pane -L 5 # -r makes it repeatable
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

### Status bar
set -g status-left ""
set -g status-left-length 100
set -ga status-left "#{?client_prefix,#{#[bg=#{@thm_red},fg=#{@thm_mantle},bold]  #S },#{#[fg=#{@thm_green}]  #S }}"
set -ga status-left "#[fg=#{@thm_overlay_0},none]│ "
# set -ga status-left "#[fg=#{@thm_blue}]  #{=/-32/...:#{s|$USER|~|:#{b:pane_current_path}}} "

set -g status-right ""
set -g status-right "#(whoami)@#h | #(date +'%b %d | %H:%M')"
set -g status-right-length 100
set -g status-position bottom
set -g status-justify left

## Monitor activity
setw -g monitor-activity on
set -g visual-activity off
# set-window-option -g window-status-activity-style bg='#444444'
set -g status-justify left
#set -g status-justify left

set -g display-time 2000

# what the border between splits looks like
set -g pane-border-style 'fg=gray'
set -g pane-active-border-style 'fg=yellow'

# setw -g window-status-current-style 'fg=black bg=cyan'

# window and pane numbers start at 1
set -g base-index 1
setw -g pane-base-index 1

### Copy tmux clipboard to system clipboard
unbind-key -T copy-mode-vi Enter
bind-key -T copy-mode-vi Enter send -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy" #\; display-message "Copied to system clipboard"

# Create new sessions with a prompt for the name
bind N command-prompt -p "New session name:" "new-session -A -s '%%'"

#setw -g aggressive-resize on

# increase the history buffer limit
set-option -g history-limit 50000

### Use CTRL-# to change to window #
### -n means attach it to the root key table
bind -n C-1 select-window -t 1
bind -n C-2 select-window -t 2
bind -n C-3 select-window -t 3
bind -n C-4 select-window -t 4
bind -n C-5 select-window -t 5
bind -n C-6 select-window -t 6
bind -n C-7 select-window -t 7
bind -n C-8 select-window -t 8
bind -n C-9 select-window -t 9

# recommended by neovim so that autoread works
set-option -g focus-events on

# add a bottom border to the bottom pane
set -g pane-border-format ""
set -g pane-border-status bottom
# set -g pane-border-style fg=colour0
# set -g pane-active-border-style fg=colour0


# catppuccin plugin config and start
set -g @catppuccin_flavor "macchiato" # latte, frappe, macchiato, mocha
set -g @catppuccin_window_current_text " #W#{?window_zoomed_flag,(),}"
set -g @catppuccin_window_text " #W#{?window_zoomed_flag,(),}"
set -g @catppuccin_status_background "none"
run ~/.config/tmux/plugins/catppuccin/tmux/catppuccin.tmux
